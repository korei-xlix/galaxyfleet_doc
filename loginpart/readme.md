# Galaxy Fleet：ログインパート仕様

## Galaxy Fleet：Login part specifications

## このドキュメントについて / About this document

**★このドキュメントの改造、流用、配布、クローンは禁止です★**  
    **Modification, diversion, distribution, and cloning of this document are prohibited**  
  
このドキュメントは「Galaxy Fleet」のユーザ仕様、パスワード認証、ユーザデータ周りの仕様を記載するものです。  
その他の仕様についてはreadmeの目次を確認してください。  





## 目次 / Table of contents

* [readme.md](/readme.md)

* [ユーザデータ仕様](#aUserData)
  * [保管領域](#aUserDataArea)
  * [データ形式](#aUserDataType)
  * [テキスト形式](#aTextType)

* [ユーザ登録](/galaxyfleet_doc/loginpart/regist.md)






<h1 id="aUserData">ユーザデータ仕様 / User Data specifications</h1>  
  

<h2 id="aUserDataArea">ユーザデータの保管領域 / User Data area</h2>  
ユーザデータを保管する領域は以下の通りです。  
  

* **ローカル / Local**  
  ユーザのブラウザのストレージに保管されます。  

* **データベース / Database**  
  サーバのデータベースに保管されます。  
  主にスコアランキングにかかわる情報を保管します。  

* **サーバテキスト / Text**  
  サーバのテキストに保管される、ユーザのプライバシーにかかわる情報です。  
  この領域に保管したデータはGalaxy Fleetのソースから認証時以外はアクセスしません。  
  また第三者には決して公開しないよう、厳重に注意します。  
  



<h2 id="aUserDataType">ユーザデータ形式 / User Data type</h2>  
ユーザデータは以下で構成されます。  
なおユーザデータはサーバのデータベースに保管されるもの、ローカルのみ保管されるものに分かれます。  
サーバのデータベースに保管されるものについては ★ で示します。  
サーバの別領域に保管し、非公開のデータは △ で示します。  
  

* **△★ ユーザID / User ID**  
  ログインに必要なユーザIDです。  
  将来的にサーバ側でも管理して、一意のIDしか存在しないようにします。  
  【半角英数字 8文字以上】  

* **★ 司令官名 / Commander Name**  
  ゲーム内で表示する司令官名です。  
  【全角16文字まで】  

* **△ X ID / X ID**  
  XのアカウントIDです。ユーザの登録認証時に必要な情報です。  
  この情報のデータベース保管、ローカル保管はおこないません。  

* **△ IP address / IP address**  
  登録時のIPアドレスです。ユーザの登録認証時に必要な情報です。  
  この情報のデータベース保管、ローカル保管はおこないません。  

* **パスワード / Password**  
  ログインに必要なパスワードです。  
  ユーザ情報に関連付けされ、ユーザが変更しない限り変わりません。  
  【12文字以上～64文字以内】  
  【使用可能な文字】
    半角英数字 < > ( ) { } ! ? @ + - * / = % # & $】  

* **パスコード / Passcode**  
  ログインに必要なパスワードです。  
  セーブデータに関連付けされ、セーブする都度変わります。  
  【半角大文字英数字 8文字】  

* **★ プロフィール / Profile**  
  司令官のプロフィール情報（テキスト）です。  
  【1024文字まで】  
  【禁止文字】
    , ' " | $

* **★ ランキングの参加可否 / Ranking On**  
  スコアランキングに参加するか、しないかの情報フラグです。  
  ランキング参加許可時にランキングに掲載します。  
  

* **★ 登録日時 / Regist TimeDate**  
  ユーザ登録がデータベースに仮入力された日時です。  
  ユーザ情報の登録日として扱います。  

* **△ 承認日時 / Confirm TimeDate**  
  ユーザ登録の認証が承認された日時です。  
  サーバテキスト上、本登録の登録日として扱います。  

* **更新日時 / Update TimeDate**  
  ユーザ情報が更新された日時です。  

* **★ 送信日時 / Send TimeDate**  
  ユーザ情報やスコアがサーバに送信された日時です。  

* **★ 名前変更日時 / Name Change TimeDate**  
  ユーザIDを最後に変更した日時です。  

* **★ 活動スコア / Score**  
  ユーザのゲームスコアです。  
  ランキング参加許可時にランキングに掲載します。  
  



<h2 id="aTextType">サーバテキストデータ仕様 / Server Text type</h2>  
サーバテキストデータは以下で構成されます。  
  
* **ユーザ情報**  
  ユーザID、X ID、IP address、登録日時を保管します。  
  ユーザ削除してもユーザIDだけは削除しません。  

* **ブラックリスト**  
  IP addressのみ保管します。  
  ブラックリストから削除するまで削除されません。  
  





<h1 id="aRegist">ユーザ登録 / Regist</h1>  
詳しくは以下をご参照ください。  
  
  [ユーザ登録](/galaxyfleet_doc/loginpart/regist.md)  
  




<h1 id="aUserAdmin">ユーザ管理 / User Admin</h1>  
詳しくは以下をご参照ください。  
  
  [ユーザ管理](/galaxyfleet_doc/loginpart/regist.md#aUserAdmin)  
  






ログイン（ゲームの続き）




ユーザ情報削除




ユーザIDの変更

ユーザIDは一度変更すると一定時間変更できない

ユーザ同志でおなじIDは使用できない
変更して未使用になったIDはサーバで保持する（手動以外では消えない）

ブラックリストのIPは、情報の保持、問い合わせをおこなわない
なので、オンラインランキングなどには計上されない




ブラックリスト






<a id="iUserConfirm"></a>
# ユーザ認証

ログイン時に、ユーザID、パスワード、パスコードが必要になります。  
パスコードは前回ゲームをやめる際、ゲームが自動的に発行します。  
  
* パスコードはゲームを終了する際、クライアントでパスコードを発行します。パスコードはランダムな半角大文字英数字です。  
* 発行されたパスコードはユーザに改変されないよう、変数内に格納し、セーブ時にセーブデータに保存します。  
* ユーザ名、パスワード、パスコードは、サーバに送信しません。  
* 認証処理の本処理は、クライアント側でおこないます。  
* ゲームを終了する際、ユーザID＋パスワード＋パスコード＋をMD5化し、認証データとしてセーブデータに保管します。  
* ログインする際、ユーザID、パスワード、パスコードを入力します。認証の際、MD5化し、セーブデータの認証データと比較してOKならログインさせます  。  
  
よって、パスワードやパスコードを忘れると、管理者（Lucida）でも復旧できず、二度とセーブデータがロードできません。  
またパスコードは使い捨てなので、第三者から盗まれたり、解析される危険性が少ないです。  






> **将来機能**  
> ユーザIDだけサーバに登録し、一意の情報として管理します。  
> このユーザIDでオンライン上でランキングなどができるかと思います。  
> ブラックリスト化された場合は、そのIPはサーバ管理から外れ、好きなIDを付けられるかわり、ランキングなどには参加できません。  
> **将来的なシステム**  
> 将来的にはユーザ間を支援する友軍システムや、スコアを表示するようなシステムを作りたい。  
> こちらは個々ではなく、総司令部が用意するシステムになる。  




ログイン系モジュール

MD5
	ハッシュの生成

UserAdm
	ユーザ情報の作成　★要confirm　←ユーザ作成
	ユーザ情報取得
	ユーザID変更　★要confirm　←ユーザID変更
	パスワード変更　★要confirm　←パスワード変更
	司令官名の変更
	コメントの変更
	ログオフ

Confirm
	ユーザ操作の承認系。操作する前にこいつから呼び出す。

	ユーザ作成
	ログイン（認証）
	ユーザID変更
	パスワード変更
	
	サーバ承認
	サーバ登録
	ブラックリスト登録（ローカル操作のみ）
	旧ユーザ解放（ローカル操作のみ）














***
[[トップへ戻る]](/readme.md)　/
[[ログインパート仕様]](readme.md)  
  
::Admin= Korei (@korei-xlix)  
::github= [https://github.com/korei-xlix/](https://github.com/korei-xlix/)  
::Web= [https://website.koreis-labo.com/](https://website.koreis-labo.com/)  
::X= [https://twitter.com/korei_xlix](https://twitter.com/korei_xlix)  
